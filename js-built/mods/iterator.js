define(function(){var a=function(a){return Object.prototype.toString.call(arguments[0])==="[object Array]"},b=function(c){return this instanceof b?(a(arguments[0])?this.collection=Array.prototype.slice.call(arguments[0]):this.collection=Array.prototype.slice.call(arguments),this.idx=0,this.length=this.collection.length,this):b.apply(new b,arguments)};return b.prototype={has:function(a){return this.collection[a]?!0:!1},hasNext:function(){return!this.isLast()},hasPrev:function(){return!this.isFirst()},isFirst:function(a){return typeof a=="undefined"?this.isFirst(this.idx):a===0},isLast:function(a){return typeof a=="undefined"?this.isLast(this.idx):a===this.length-1},get:function(a){return this.collection[a]},current:function(){return this.get(this.idx)},next:function(){return this.hasNext()?this.setIdx(this.idx+1).current():this.isLooping?(this.isLooping=!1,this.first()):null},prev:function(){return this.hasPrev()?this.setIdx(this.idx-1).current():this.isLooping?(this.isLooping=!1,this.last()):null},first:function(){return this.setIdx(0),this.current()},last:function(){return this.setIdx(this.length-1),this.current()},setIdx:function(a){if(!this.has(a))throw new Error("idx out of bounds - collection does not include that index");return this.idx=a,this},loop:function(){return this.isLooping=!0,this},each:function(a,b){var c;if(typeof a!="function")throw new Error("callback is of type "+typeof a+" expected a function");b&&(c=b);for(var d=0,e=this.length;d<e;d+=1)a.call(c,this.collection[d],d);return this},add:function(b,c){a(b)||(b=[b]);if(typeof c=="undefined"||!this.has(c))c=this.length;for(var d=0,e=b.length;d<e;d+=1)this.collection.splice(c+d,0,b[d]);return this.length=this.collection.length,this},remove:function(a){return typeof a=="number"&&this.collection.splice(a,1),this.length=this.collection.length,this},update:function(a,b){if(!this.has(b))throw new Error("idx out of bounds - collection does not include that index");return this.collection[b]=a,this},filter:function(a){var c=[];for(var d=0,e=this.length;d<e;d+=1)a(this.collection[d])&&c.push(this.collection[d]);return new b(c)}},b})